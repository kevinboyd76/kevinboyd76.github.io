<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Kevin Boyd &amp; Scott Frazier" />


<title>Budweiser Case Study</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">My Website</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="About_Me.html">About Me</a>
</li>
<li>
  <a href="DDS_Project1.html">Budweiser Case Study</a>
</li>
<li>
  <a href="CLT2.html">CLT2</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Budweiser Case Study</h1>
<h4 class="author">Kevin Boyd &amp; Scott Frazier</h4>
<h4 class="date">10/6/2021</h4>

</div>

<div id="TOC">
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#load-libraries">Load Libraries</a></li>
<li><a href="#load-in-the-data">Load in the data</a></li>
<li><a href="#look-at-the-data">Look at the data</a></li>
<li><a href="#number-1---number-of-breweries-in-each-state">Number 1 - Number of Breweries in Each State</a></li>
<li><a href="#number-2---merge-the-datasets">Number 2 - Merge the Datasets</a></li>
<li><a href="#number-3---missing-values">Number 3 - Missing Values</a></li>
<li><a href="#number-4a---median-abv-by-state">Number 4a - Median ABV by State</a></li>
<li><a href="#number-4b---median-ibu-by-state">Number 4b - Median IBU by State</a></li>
<li><a href="#number-5a---maximum-abv-and-ibu">Number 5a - Maximum ABV and IBU</a></li>
<li><a href="#number-5b---top-5-states-with-highest-ibu">Number 5b - Top 5 States with Highest IBU</a></li>
<li><a href="#number-5c---top-5-states-with-highest-abv">Number 5c - Top 5 States with Highest ABV</a></li>
<li><a href="#number-6---distribution-of-abv">Number 6 - Distribution of ABV</a></li>
<li><a href="#number-7---relationship-between-abv-and-ibu">Number 7 - Relationship between ABV and IBU</a></li>
<li><a href="#number-8a---k-nn-model">Number 8a - k-NN Model</a></li>
<li><a href="#number-8b---find-best-k-value">Number 8b - Find Best k Value</a></li>
<li><a href="#number-8c---k-nn-model-with-optimized-k">Number 8c - k-NN Model with Optimized k</a></li>
<li><a href="#number-8d---test-abv-ibu-contribution-to-model-accuracy">Number 8d - Test ABV &amp; IBU Contribution to Model Accuracy</a></li>
<li><a href="#number-9a---interesting-relationships">Number 9a - Interesting Relationships</a></li>
<li><a href="#number-9b---median-abv-and-ibu-by-state">Number 9b - Median ABV and IBU by State</a></li>
<li><a href="#conclusion">Conclusion</a></li>
</ul>
</div>

<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>Our goal was to perform an EDA by identifying errors and recognizing patterns that are present in the beers and breweries data sets given to us by Budweiser. Much of the work consisted of creating visual aids to show insights from the data. We addressed the relationship between alcohol content and the bitterness using multiple plots and methods. We also utilized a k-NN model to address the relationship between ALE and IPA. As a result this EDA shows how some of the most important components of beer relate to each other.</p>
</div>
<div id="load-libraries" class="section level1">
<h1>Load Libraries</h1>
<pre class="r"><code>library(tidyverse)
library(RColorBrewer)
library(cowplot)
library(class)
library(caret)
library(e1071)
library(stringr)
library(maps)
library(mapproj)</code></pre>
</div>
<div id="load-in-the-data" class="section level1">
<h1>Load in the data</h1>
<pre class="r"><code>beers &lt;- read.csv(&quot;beers.csv&quot;, header = T)
breweries &lt;- read.csv(&quot;breweries.csv&quot;, header = T)</code></pre>
</div>
<div id="look-at-the-data" class="section level1">
<h1>Look at the data</h1>
<pre class="r"><code>str(beers)</code></pre>
<pre><code>## &#39;data.frame&#39;:    2410 obs. of  7 variables:
##  $ Name      : chr  &quot;Pub Beer&quot; &quot;Devil&#39;s Cup&quot; &quot;Rise of the Phoenix&quot; &quot;Sinister&quot; ...
##  $ Beer_ID   : int  1436 2265 2264 2263 2262 2261 2260 2259 2258 2131 ...
##  $ ABV       : num  0.05 0.066 0.071 0.09 0.075 0.077 0.045 0.065 0.055 0.086 ...
##  $ IBU       : int  NA NA NA NA NA NA NA NA NA NA ...
##  $ Brewery_id: int  409 178 178 178 178 178 178 178 178 178 ...
##  $ Style     : chr  &quot;American Pale Lager&quot; &quot;American Pale Ale (APA)&quot; &quot;American IPA&quot; &quot;American Double / Imperial IPA&quot; ...
##  $ Ounces    : num  12 12 12 12 12 12 12 12 12 12 ...</code></pre>
<pre class="r"><code>str(breweries)</code></pre>
<pre><code>## &#39;data.frame&#39;:    558 obs. of  4 variables:
##  $ Brew_ID: int  1 2 3 4 5 6 7 8 9 10 ...
##  $ Name   : chr  &quot;NorthGate Brewing &quot; &quot;Against the Grain Brewery&quot; &quot;Jack&#39;s Abby Craft Lagers&quot; &quot;Mike Hess Brewing Company&quot; ...
##  $ City   : chr  &quot;Minneapolis&quot; &quot;Louisville&quot; &quot;Framingham&quot; &quot;San Diego&quot; ...
##  $ State  : chr  &quot; MN&quot; &quot; KY&quot; &quot; MA&quot; &quot; CA&quot; ...</code></pre>
<pre class="r"><code>head(beers)</code></pre>
<pre><code>##                  Name Beer_ID   ABV IBU Brewery_id                          Style Ounces
## 1            Pub Beer    1436 0.050  NA        409            American Pale Lager     12
## 2         Devil&#39;s Cup    2265 0.066  NA        178        American Pale Ale (APA)     12
## 3 Rise of the Phoenix    2264 0.071  NA        178                   American IPA     12
## 4            Sinister    2263 0.090  NA        178 American Double / Imperial IPA     12
## 5       Sex and Candy    2262 0.075  NA        178                   American IPA     12
## 6        Black Exodus    2261 0.077  NA        178                  Oatmeal Stout     12</code></pre>
<pre class="r"><code>head(breweries)</code></pre>
<pre><code>##   Brew_ID                      Name          City State
## 1       1        NorthGate Brewing    Minneapolis    MN
## 2       2 Against the Grain Brewery    Louisville    KY
## 3       3  Jack&#39;s Abby Craft Lagers    Framingham    MA
## 4       4 Mike Hess Brewing Company     San Diego    CA
## 5       5   Fort Point Beer Company San Francisco    CA
## 6       6     COAST Brewing Company    Charleston    SC</code></pre>
</div>
<div id="number-1---number-of-breweries-in-each-state" class="section level1">
<h1>Number 1 - Number of Breweries in Each State</h1>
<pre class="r"><code>#ordered plot showing counts of breweries per state
brewbystate &lt;- breweries %&gt;%
  group_by(State) %&gt;%
  summarise(count = n()) %&gt;%
  ggplot(aes(x=reorder(State,(-count)), y = count)) +
  geom_bar(stat = &quot;identity&quot;,fill=&quot;blue&quot;) +
  theme(axis.text.x=element_text(angle=90)) +
  ggtitle(&quot;Number of Breweries by State&quot;) +
  xlab(&quot;State&quot;) +
  ylab(&quot;Count&quot;)
brewbystate + theme(axis.text.x=element_text(vjust=0.5))</code></pre>
<p><img src="DDS_Project1_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
</div>
<div id="number-2---merge-the-datasets" class="section level1">
<h1>Number 2 - Merge the Datasets</h1>
<pre class="r"><code>#merge data sets on Brewery_id
names(breweries)[1] &lt;- &quot;Brewery_id&quot;
df1 &lt;- merge(beers, breweries, by = &quot;Brewery_id&quot;, all = T)
names(df1)[2] &lt;- &quot;Beer&quot;
names(df1)[8] &lt;- &quot;Brewery&quot;
str(df1)</code></pre>
<pre><code>## &#39;data.frame&#39;:    2410 obs. of  10 variables:
##  $ Brewery_id: int  1 1 1 1 1 1 2 2 2 2 ...
##  $ Beer      : chr  &quot;Get Together&quot; &quot;Maggie&#39;s Leap&quot; &quot;Wall&#39;s End&quot; &quot;Pumpion&quot; ...
##  $ Beer_ID   : int  2692 2691 2690 2689 2688 2687 2686 2685 2684 2683 ...
##  $ ABV       : num  0.045 0.049 0.048 0.06 0.06 0.056 0.08 0.125 0.077 0.042 ...
##  $ IBU       : int  50 26 19 38 25 47 68 80 25 42 ...
##  $ Style     : chr  &quot;American IPA&quot; &quot;Milk / Sweet Stout&quot; &quot;English Brown Ale&quot; &quot;Pumpkin Ale&quot; ...
##  $ Ounces    : num  16 16 16 16 16 16 16 16 16 16 ...
##  $ Brewery   : chr  &quot;NorthGate Brewing &quot; &quot;NorthGate Brewing &quot; &quot;NorthGate Brewing &quot; &quot;NorthGate Brewing &quot; ...
##  $ City      : chr  &quot;Minneapolis&quot; &quot;Minneapolis&quot; &quot;Minneapolis&quot; &quot;Minneapolis&quot; ...
##  $ State     : chr  &quot; MN&quot; &quot; MN&quot; &quot; MN&quot; &quot; MN&quot; ...</code></pre>
<pre class="r"><code>head(df1)</code></pre>
<pre><code>##   Brewery_id          Beer Beer_ID   ABV IBU                               Style Ounces
## 1          1  Get Together    2692 0.045  50                        American IPA     16
## 2          1 Maggie&#39;s Leap    2691 0.049  26                  Milk / Sweet Stout     16
## 3          1    Wall&#39;s End    2690 0.048  19                   English Brown Ale     16
## 4          1       Pumpion    2689 0.060  38                         Pumpkin Ale     16
## 5          1    Stronghold    2688 0.060  25                     American Porter     16
## 6          1   Parapet ESB    2687 0.056  47 Extra Special / Strong Bitter (ESB)     16
##              Brewery        City State
## 1 NorthGate Brewing  Minneapolis    MN
## 2 NorthGate Brewing  Minneapolis    MN
## 3 NorthGate Brewing  Minneapolis    MN
## 4 NorthGate Brewing  Minneapolis    MN
## 5 NorthGate Brewing  Minneapolis    MN
## 6 NorthGate Brewing  Minneapolis    MN</code></pre>
<pre class="r"><code>tail(df1)</code></pre>
<pre><code>##      Brewery_id                      Beer Beer_ID   ABV IBU                   Style Ounces
## 2405        556             Pilsner Ukiah      98 0.055  NA         German Pilsener     12
## 2406        557  Heinnieweisse Weissebier      52 0.049  NA              Hefeweizen     12
## 2407        557           Snapperhead IPA      51 0.068  NA            American IPA     12
## 2408        557         Moo Thunder Stout      50 0.049  NA      Milk / Sweet Stout     12
## 2409        557         Porkslap Pale Ale      49 0.043  NA American Pale Ale (APA)     12
## 2410        558 Urban Wilderness Pale Ale      30 0.049  NA        English Pale Ale     12
##                            Brewery          City State
## 2405         Ukiah Brewing Company         Ukiah    CA
## 2406       Butternuts Beer and Ale Garrattsville    NY
## 2407       Butternuts Beer and Ale Garrattsville    NY
## 2408       Butternuts Beer and Ale Garrattsville    NY
## 2409       Butternuts Beer and Ale Garrattsville    NY
## 2410 Sleeping Lady Brewing Company     Anchorage    AK</code></pre>
</div>
<div id="number-3---missing-values" class="section level1">
<h1>Number 3 - Missing Values</h1>
<pre class="r"><code>#number of NAs in each data set
Beers_NAs &lt;- sum(is.na(beers))
Brewery_NAs &lt;- sum(is.na(breweries))
NA.df &lt;- data.frame(Measure = c(&quot;Beers Data&quot;, &quot;Breweries Data&quot;), 
                    Value = c(Beers_NAs,Brewery_NAs))
NA.dataset &lt;- ggplot(NA.df, aes(x=Measure, y=Value)) +
  geom_bar(stat = &quot;identity&quot;, fill = &quot;red3&quot;) +
  ggtitle(&quot;Missing Data in each Dataset&quot;) +
  xlab(&quot;Dataset&quot;) +
  ylab(&quot;Number of NAs&quot;)

#which rows are the NAs coming from?
ABV_NAs &lt;- sum(is.na(beers$ABV))
IBU_NAs &lt;- sum(is.na(beers$IBU))
DataLength &lt;- NROW(beers$ABV)

#make data frame from number of NAs
NA.df1 &lt;- data.frame(Measure = c(&quot;ABV&quot;,&quot;IBU&quot;),
                     Value = c(ABV_NAs,IBU_NAs))

#plot the NA values from each column
NA.column &lt;- ggplot(NA.df1, aes(x=Measure, y=Value)) +
  geom_bar(stat = &quot;identity&quot;, fill = &quot;purple2&quot;) +
  ggtitle(&quot;Missing Data for ABV and IBU&quot;) +
  ylab(&quot;Number of NAs&quot;) +
  xlab(&quot;Column in Dataset&quot;)

#make a pie chart for ABV
NA.df2 &lt;- data.frame(Measure = c(&quot;ABV&quot;,&quot;ABV&quot;), 
                     Data = c(&quot;Missing&quot;,&quot;Total&quot;),
                     Value = c(ABV_NAs,(DataLength-ABV_NAs)))

bp1 &lt;- ggplot(NA.df2, aes(x=&quot;&quot;, y=Value, fill=Data)) +
  geom_bar(width = 1, stat = &quot;identity&quot;) + xlab(&quot;&quot;) + ylab(&quot;&quot;) + ggtitle(&quot;Missing ABV Data&quot;)
pie1 &lt;- bp1 + coord_polar(&quot;y&quot;, start=0)
pie1</code></pre>
<p><img src="DDS_Project1_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<pre class="r"><code>#make pie chart for IBU
NA.df3 &lt;- data.frame(Measure = c(&quot;IBU&quot;,&quot;IBU&quot;), 
                     Data = c(&quot;Missing&quot;,&quot;Total&quot;),
                     Value = c(IBU_NAs,(DataLength - IBU_NAs)))

bp2 &lt;- ggplot(NA.df3, aes(x=&quot;&quot;, y=Value, fill=Data)) +
  geom_bar(width = 1, stat = &quot;identity&quot;) + xlab(&quot;&quot;) + ylab(&quot;&quot;) + ggtitle(&quot;Missing IBU Data&quot;)
pie2 &lt;- bp2 + coord_polar(&quot;y&quot;, start=0)
pie2</code></pre>
<p><img src="DDS_Project1_files/figure-html/unnamed-chunk-6-2.png" width="672" /></p>
<pre class="r"><code>#put all the plots together
NAplots &lt;- plot_grid(NA.dataset,NA.column,pie1,pie2, labels = c(&quot;A&quot;,&quot;B&quot;,&quot;C&quot;,&quot;D&quot;))
NAplots</code></pre>
<p><img src="DDS_Project1_files/figure-html/unnamed-chunk-6-3.png" width="672" /></p>
</div>
<div id="number-4a---median-abv-by-state" class="section level1">
<h1>Number 4a - Median ABV by State</h1>
<pre class="r"><code>#plot showing the median ABV value per state
ABV_Values &lt;- df1 %&gt;% group_by(State) %&gt;%
  summarize(medianABV = median(ABV, na.rm = T)) %&gt;%
  ggplot(aes(x=reorder(State,(-medianABV)), y=medianABV)) +
  geom_bar(stat = &quot;identity&quot;, fill=&quot;#377eb8&quot;) +
  theme(axis.text.x=element_text(angle=90)) +
  ggtitle(&quot;Median ABV Values by State&quot;) +
  xlab(&quot;State&quot;) +
  ylab(&quot;Median ABV Value&quot;)
ABV_Values + theme(axis.text.x=element_text(vjust=0.5))</code></pre>
<p><img src="DDS_Project1_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
</div>
<div id="number-4b---median-ibu-by-state" class="section level1">
<h1>Number 4b - Median IBU by State</h1>
<pre class="r"><code>#plot showing the median IBU value per state
IBU_Values &lt;- df1 %&gt;% group_by(State) %&gt;%
  summarize(medianIBU = median(IBU, na.rm = T)) %&gt;%
  ggplot(aes(x=reorder(State,(-medianIBU)), y=medianIBU)) +
  geom_bar(stat = &quot;identity&quot;, fill=&quot;#4daf4a&quot;) +
  theme(axis.text.x=element_text(angle=90)) +
  ggtitle(&quot;Median IBU Values by State&quot;) +
  xlab(&quot;State&quot;) +
  ylab(&quot;Median IBU Value&quot;)
IBU_Values + theme(axis.text.x=element_text(vjust=0.5))</code></pre>
<pre><code>## Warning: Removed 1 rows containing missing values (position_stack).</code></pre>
<p><img src="DDS_Project1_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
<div id="number-5a---maximum-abv-and-ibu" class="section level1">
<h1>Number 5a - Maximum ABV and IBU</h1>
<pre class="r"><code>#make data frames with top 5 ABV and IBU values
df2 &lt;- df1[order(df1$ABV,decreasing = T),]
df2 &lt;- df2[c(1,2,3,5,6),c(4,10)]
df3 &lt;- df1[order(df1$IBU,decreasing = T),]
df3 &lt;- df3[c(1:5),c(5,10)]</code></pre>
</div>
<div id="number-5b---top-5-states-with-highest-ibu" class="section level1">
<h1>Number 5b - Top 5 States with Highest IBU</h1>
<p><strong>Oregon has the highest IBU beer</strong></p>
<pre class="r"><code>#plot the top 5 states for IBU
ggplot(df3, aes(x = reorder(State, -IBU), y = IBU)) + 
  geom_bar(stat = &quot;identity&quot;, fill = &quot;#4daf4a&quot;) +
  ylim(0,150) +
  ggtitle(&quot;Top 5 States IBU&quot;) +
  xlab(&quot;State&quot;) +
  geom_text(aes(label=IBU), vjust=-1) +
  ylab(&quot;IBU (International Bitterness Units)&quot;)</code></pre>
<p><img src="DDS_Project1_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
</div>
<div id="number-5c---top-5-states-with-highest-abv" class="section level1">
<h1>Number 5c - Top 5 States with Highest ABV</h1>
<p><strong>Colorado has the highest ABV beer</strong></p>
<pre class="r"><code>#plot the top states for ABV
ggplot(df2, aes(x = reorder(State, -ABV), y = ABV)) + 
  geom_bar(stat = &quot;identity&quot;, fill= &quot;#377eb8&quot;) +
  ylim(0,0.15) +
  ggtitle(&quot;Top 5 States ABV&quot;) +
  xlab(&quot;State&quot;) +
  geom_text(aes(label=ABV), vjust=-1) +
  ylab(&quot;ABV (Alcohol by Volume)&quot;)</code></pre>
<p><img src="DDS_Project1_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
<div id="number-6---distribution-of-abv" class="section level1">
<h1>Number 6 - Distribution of ABV</h1>
<p><strong>The evidence suggests the distribution of ABV is right skewed with a median value of 0.056 with a mean of 0.0598. There are a number of values greater than 0.1 that make it appear to be right skewed.</strong></p>
<pre class="r"><code>#Summary stats of ABV
summary(df1$ABV)</code></pre>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA&#39;s 
## 0.00100 0.05000 0.05600 0.05977 0.06700 0.12800      62</code></pre>
<pre class="r"><code>#Distributions
#Histogram of ABV in df1
df1 %&gt;% ggplot(aes(x=ABV)) + geom_histogram(fill = &quot;#377eb8&quot;) + ggtitle(&quot;Different ABV Values of Beer&quot;) + labs(x=&quot;ABV (Alcohol by Volume)&quot;, y=&quot;Frequency&quot;)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## Warning: Removed 62 rows containing non-finite values (stat_bin).</code></pre>
<p><img src="DDS_Project1_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<pre class="r"><code>#boxplot
df1 %&gt;% ggplot(aes(x=ABV)) + geom_boxplot(fill = &quot;#377eb8&quot;) + ggtitle(&quot;Different ABV Values of Beer&quot;) + labs(x=&quot;ABV (Alcohol by Volume)&quot;, y=&quot;&quot;) + coord_flip()</code></pre>
<pre><code>## Warning: Removed 62 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="DDS_Project1_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
<pre class="r"><code>#geom_density
ABV_vizz = ggplot(df1, aes(x = ABV))

ABV_vizz + geom_density(fill = &quot;#377eb8&quot;, alpha=0.6) +
  geom_vline(aes(xintercept = mean(ABV)), 
             linetype = &quot;dashed&quot;, size = 0.6,
             color = &quot;#FC4E07&quot;) +
  ylab(&quot;Frequency&quot;) +
  ggtitle(&quot;Different ABV Values of Beer&quot;) +
  xlab(&quot;ABV (Alcohol by Volume)&quot;)</code></pre>
<pre><code>## Warning: Removed 62 rows containing non-finite values (stat_density).</code></pre>
<pre><code>## Warning: Removed 2410 rows containing missing values (geom_vline).</code></pre>
<p><img src="DDS_Project1_files/figure-html/unnamed-chunk-12-3.png" width="672" /></p>
</div>
<div id="number-7---relationship-between-abv-and-ibu" class="section level1">
<h1>Number 7 - Relationship between ABV and IBU</h1>
<p><strong>There is evidence of a positive relationship between ABV and IBU. We also notice that a majority of the data points are at 0.05 ABV and 35 IBU</strong></p>
<pre class="r"><code>ggplot(df1, aes(x=ABV, y=IBU)) +
  geom_point() +
  geom_jitter() +
  geom_smooth() +
  ggtitle(&quot;Relationship Between ABV vs IBU&quot;)</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;gam&#39; and formula &#39;y ~ s(x, bs = &quot;cs&quot;)&#39;</code></pre>
<pre><code>## Warning: Removed 1005 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>## Warning: Removed 1005 rows containing missing values (geom_point).

## Warning: Removed 1005 rows containing missing values (geom_point).</code></pre>
<p><img src="DDS_Project1_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="number-8a---k-nn-model" class="section level1">
<h1>Number 8a - k-NN Model</h1>
<pre class="r"><code>#Make new column with ALE, IPA, or Other as identifier
df1$Type = ifelse(grepl(&quot;\\bale\\b&quot;, df1$Style, ignore.case = T), &quot;ALE&quot;,
                  ifelse(grepl(&quot;\\bipa\\b&quot;, df1$Style, ignore.case = T), &quot;IPA&quot;, &quot;Other&quot;))
head(df1)</code></pre>
<pre><code>##   Brewery_id          Beer Beer_ID   ABV IBU                               Style Ounces
## 1          1  Get Together    2692 0.045  50                        American IPA     16
## 2          1 Maggie&#39;s Leap    2691 0.049  26                  Milk / Sweet Stout     16
## 3          1    Wall&#39;s End    2690 0.048  19                   English Brown Ale     16
## 4          1       Pumpion    2689 0.060  38                         Pumpkin Ale     16
## 5          1    Stronghold    2688 0.060  25                     American Porter     16
## 6          1   Parapet ESB    2687 0.056  47 Extra Special / Strong Bitter (ESB)     16
##              Brewery        City State  Type
## 1 NorthGate Brewing  Minneapolis    MN   IPA
## 2 NorthGate Brewing  Minneapolis    MN Other
## 3 NorthGate Brewing  Minneapolis    MN   ALE
## 4 NorthGate Brewing  Minneapolis    MN   ALE
## 5 NorthGate Brewing  Minneapolis    MN Other
## 6 NorthGate Brewing  Minneapolis    MN Other</code></pre>
<pre class="r"><code>#Make new data frame with only Ale beers
aleIPA &lt;- df1 %&gt;% filter(df1$Type == &quot;ALE&quot; | df1$Type == &quot;IPA&quot;)
head(aleIPA)</code></pre>
<pre><code>##   Brewery_id           Beer Beer_ID   ABV IBU                          Style Ounces
## 1          1   Get Together    2692 0.045  50                   American IPA     16
## 2          1     Wall&#39;s End    2690 0.048  19              English Brown Ale     16
## 3          1        Pumpion    2689 0.060  38                    Pumpkin Ale     16
## 4          2 Citra Ass Down    2686 0.080  68 American Double / Imperial IPA     16
## 5          2         A Beer    2683 0.042  42        American Pale Ale (APA)     16
## 6          2  Flesh Gourd&#39;n    2681 0.066  21                    Pumpkin Ale     16
##                     Brewery        City State Type
## 1        NorthGate Brewing  Minneapolis    MN  IPA
## 2        NorthGate Brewing  Minneapolis    MN  ALE
## 3        NorthGate Brewing  Minneapolis    MN  ALE
## 4 Against the Grain Brewery  Louisville    KY  IPA
## 5 Against the Grain Brewery  Louisville    KY  ALE
## 6 Against the Grain Brewery  Louisville    KY  ALE</code></pre>
<pre class="r"><code>#Make training and test data frames
splitPerc &lt;- .7
trainIndices &lt;- sample(1:dim(aleIPA)[1],round(splitPerc * dim(aleIPA)[1]))
dfTrain &lt;- aleIPA[trainIndices,]
dfTest &lt;- aleIPA[-trainIndices,]

#Omit the NAs
dfTrain &lt;- na.omit(dfTrain)
dfTest &lt;- na.omit(dfTest)

#knn model
classifications &lt;- knn(dfTrain[,4:5], dfTest[,4:5], dfTrain$Type, k = 10, prob = TRUE)
table(dfTest$Type,classifications)</code></pre>
<pre><code>##      classifications
##       ALE IPA
##   ALE 167  23
##   IPA  25  79</code></pre>
<pre class="r"><code>confusionMatrix(table(dfTest$Type,classifications))</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##      classifications
##       ALE IPA
##   ALE 167  23
##   IPA  25  79
##                                           
##                Accuracy : 0.8367          
##                  95% CI : (0.7894, 0.8771)
##     No Information Rate : 0.6531          
##     P-Value [Acc &gt; NIR] : 1.69e-12        
##                                           
##                   Kappa : 0.6414          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.8852          
##                                           
##             Sensitivity : 0.8698          
##             Specificity : 0.7745          
##          Pos Pred Value : 0.8789          
##          Neg Pred Value : 0.7596          
##              Prevalence : 0.6531          
##          Detection Rate : 0.5680          
##    Detection Prevalence : 0.6463          
##       Balanced Accuracy : 0.8222          
##                                           
##        &#39;Positive&#39; Class : ALE             
## </code></pre>
</div>
<div id="number-8b---find-best-k-value" class="section level1">
<h1>Number 8b - Find Best k Value</h1>
<pre class="r"><code>#Loop for many k and the average of many training / test partition
iterations = 100
numks = 50

masterAcc = matrix(nrow = iterations, ncol = numks)

for(j in 1:iterations)
{
  accs = data.frame(accuracy = numeric(100), k = numeric(100))
  trainIndices = sample(1:dim(aleIPA)[1],round(splitPerc * dim(aleIPA)[1]))
  train = aleIPA[trainIndices,]
  test = aleIPA[-trainIndices,]
  train = na.omit(train)
  test = na.omit(test)
  for(i in 1:numks)
  {
    classifications = knn(train[,c(4,5)],test[,c(4,5)],train$Type, prob = TRUE, k = i)
    table(classifications,test$Type)
    CM = confusionMatrix(table(classifications,test$Type))
    masterAcc[j,i] = CM$overall[1]
  }
  
}

MeanAcc = colMeans(masterAcc)

plot(seq(1,numks,1),MeanAcc, type = &quot;l&quot;, xlab = &quot;k&quot;, ylab = &quot;Mean Accuracy&quot;, main = &quot;Mean Accuracy of k Values&quot;)</code></pre>
<p><img src="DDS_Project1_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
</div>
<div id="number-8c---k-nn-model-with-optimized-k" class="section level1">
<h1>Number 8c - k-NN Model with Optimized k</h1>
<pre class="r"><code>#k-NN model using best value of k 
classifications4 &lt;- knn(dfTrain[,4:5], dfTest[,4:5], dfTrain$Type, k = 6, prob = TRUE)
table(dfTest$Type,classifications4)</code></pre>
<pre><code>##      classifications4
##       ALE IPA
##   ALE 163  27
##   IPA  25  79</code></pre>
<pre class="r"><code>confusionMatrix(table(dfTest$Type,classifications4))</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##      classifications4
##       ALE IPA
##   ALE 163  27
##   IPA  25  79
##                                          
##                Accuracy : 0.8231         
##                  95% CI : (0.7746, 0.865)
##     No Information Rate : 0.6395         
##     P-Value [Acc &gt; NIR] : 3.426e-12      
##                                          
##                   Kappa : 0.6148         
##                                          
##  Mcnemar&#39;s Test P-Value : 0.8897         
##                                          
##             Sensitivity : 0.8670         
##             Specificity : 0.7453         
##          Pos Pred Value : 0.8579         
##          Neg Pred Value : 0.7596         
##              Prevalence : 0.6395         
##          Detection Rate : 0.5544         
##    Detection Prevalence : 0.6463         
##       Balanced Accuracy : 0.8062         
##                                          
##        &#39;Positive&#39; Class : ALE            
## </code></pre>
</div>
<div id="number-8d---test-abv-ibu-contribution-to-model-accuracy" class="section level1">
<h1>Number 8d - Test ABV &amp; IBU Contribution to Model Accuracy</h1>
<p><strong>Both ABV and IBU allowed high accuracy in our model predicting if a beer is considered an IPA, but IBU was the best measure in the model.</strong></p>
<pre class="r"><code>#knn internal model for ABV and IBU
classifications1 &lt;- knn.cv(dfTrain[,4:5],dfTrain$Type, k = 10)
confusionMatrix(table(classifications1,dfTrain$Type))</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##                 
## classifications1 ALE IPA
##              ALE 341  65
##              IPA  28 216
##                                           
##                Accuracy : 0.8569          
##                  95% CI : (0.8276, 0.8829)
##     No Information Rate : 0.5677          
##     P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
##                                           
##                   Kappa : 0.7039          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.0001892       
##                                           
##             Sensitivity : 0.9241          
##             Specificity : 0.7687          
##          Pos Pred Value : 0.8399          
##          Neg Pred Value : 0.8852          
##              Prevalence : 0.5677          
##          Detection Rate : 0.5246          
##    Detection Prevalence : 0.6246          
##       Balanced Accuracy : 0.8464          
##                                           
##        &#39;Positive&#39; Class : ALE             
## </code></pre>
<pre class="r"><code>#knn model for ABV
classifications2 &lt;- knn.cv(dfTrain[,4],dfTrain$Type, k = 10)
confusionMatrix(table(classifications2,dfTrain$Type))</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##                 
## classifications2 ALE IPA
##              ALE 293  49
##              IPA  76 232
##                                           
##                Accuracy : 0.8077          
##                  95% CI : (0.7753, 0.8373)
##     No Information Rate : 0.5677          
##     P-Value [Acc &gt; NIR] : &lt; 2e-16         
##                                           
##                   Kappa : 0.6126          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.02004         
##                                           
##             Sensitivity : 0.7940          
##             Specificity : 0.8256          
##          Pos Pred Value : 0.8567          
##          Neg Pred Value : 0.7532          
##              Prevalence : 0.5677          
##          Detection Rate : 0.4508          
##    Detection Prevalence : 0.5262          
##       Balanced Accuracy : 0.8098          
##                                           
##        &#39;Positive&#39; Class : ALE             
## </code></pre>
<pre class="r"><code>#knn model for IBU
classifications3 &lt;- knn.cv(dfTrain[,5],dfTrain$Type, k = 10)
confusionMatrix(table(classifications3,dfTrain$Type))</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##                 
## classifications3 ALE IPA
##              ALE 328  50
##              IPA  41 231
##                                           
##                Accuracy : 0.86            
##                  95% CI : (0.8309, 0.8858)
##     No Information Rate : 0.5677          
##     P-Value [Acc &gt; NIR] : &lt;2e-16          
##                                           
##                   Kappa : 0.7137          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.4017          
##                                           
##             Sensitivity : 0.8889          
##             Specificity : 0.8221          
##          Pos Pred Value : 0.8677          
##          Neg Pred Value : 0.8493          
##              Prevalence : 0.5677          
##          Detection Rate : 0.5046          
##    Detection Prevalence : 0.5815          
##       Balanced Accuracy : 0.8555          
##                                           
##        &#39;Positive&#39; Class : ALE             
## </code></pre>
</div>
<div id="number-9a---interesting-relationships" class="section level1">
<h1>Number 9a - Interesting Relationships</h1>
<pre class="r"><code># make new column with beer identifiers and make into a factor
df1$New &lt;- ifelse(grepl(&quot;\\bale\\b&quot;, df1$Style, ignore.case = T), &quot;ALE&quot;,
                  ifelse(grepl(&quot;\\bipa\\b&quot;, df1$Style, ignore.case = T), &quot;IPA&quot;,
                         ifelse(grepl(&quot;\\bWheat\\b&quot;, df1$Style, ignore.case = T), &quot;Wheat&quot;,
                                ifelse(grepl(&quot;\\bAmber\\b&quot;, df1$Style, ignore.case = T), &quot;Amber&quot;,
                                       ifelse(grepl(&quot;\\bStout\\b&quot;, df1$ Style, ignore.case = T), &quot;Stout&quot;,
                                              ifelse(grepl(&quot;\\bLager\\b&quot;, df1$Style, ignore.case = T), &quot;Lager&quot;,
                                                     ifelse(grepl(&quot;\\bPorter\\b&quot;, df1$Style, ignore.case = T), &quot;Porter&quot;,
                                                            ifelse(grepl(&quot;\\bPilsner\\b&quot;, df1$Style, ignore.case = T), &quot;Pilsner&quot;,
                                                                   &quot;Other&quot;))))))))
head(df1)</code></pre>
<pre><code>##   Brewery_id          Beer Beer_ID   ABV IBU                               Style Ounces
## 1          1  Get Together    2692 0.045  50                        American IPA     16
## 2          1 Maggie&#39;s Leap    2691 0.049  26                  Milk / Sweet Stout     16
## 3          1    Wall&#39;s End    2690 0.048  19                   English Brown Ale     16
## 4          1       Pumpion    2689 0.060  38                         Pumpkin Ale     16
## 5          1    Stronghold    2688 0.060  25                     American Porter     16
## 6          1   Parapet ESB    2687 0.056  47 Extra Special / Strong Bitter (ESB)     16
##              Brewery        City State  Type    New
## 1 NorthGate Brewing  Minneapolis    MN   IPA    IPA
## 2 NorthGate Brewing  Minneapolis    MN Other  Stout
## 3 NorthGate Brewing  Minneapolis    MN   ALE    ALE
## 4 NorthGate Brewing  Minneapolis    MN   ALE    ALE
## 5 NorthGate Brewing  Minneapolis    MN Other Porter
## 6 NorthGate Brewing  Minneapolis    MN Other  Other</code></pre>
<pre class="r"><code>df1$New &lt;- as.factor(df1$New)
str(df1)</code></pre>
<pre><code>## &#39;data.frame&#39;:    2410 obs. of  12 variables:
##  $ Brewery_id: int  1 1 1 1 1 1 2 2 2 2 ...
##  $ Beer      : chr  &quot;Get Together&quot; &quot;Maggie&#39;s Leap&quot; &quot;Wall&#39;s End&quot; &quot;Pumpion&quot; ...
##  $ Beer_ID   : int  2692 2691 2690 2689 2688 2687 2686 2685 2684 2683 ...
##  $ ABV       : num  0.045 0.049 0.048 0.06 0.06 0.056 0.08 0.125 0.077 0.042 ...
##  $ IBU       : int  50 26 19 38 25 47 68 80 25 42 ...
##  $ Style     : chr  &quot;American IPA&quot; &quot;Milk / Sweet Stout&quot; &quot;English Brown Ale&quot; &quot;Pumpkin Ale&quot; ...
##  $ Ounces    : num  16 16 16 16 16 16 16 16 16 16 ...
##  $ Brewery   : chr  &quot;NorthGate Brewing &quot; &quot;NorthGate Brewing &quot; &quot;NorthGate Brewing &quot; &quot;NorthGate Brewing &quot; ...
##  $ City      : chr  &quot;Minneapolis&quot; &quot;Minneapolis&quot; &quot;Minneapolis&quot; &quot;Minneapolis&quot; ...
##  $ State     : chr  &quot; MN&quot; &quot; MN&quot; &quot; MN&quot; &quot; MN&quot; ...
##  $ Type      : chr  &quot;IPA&quot; &quot;Other&quot; &quot;ALE&quot; &quot;ALE&quot; ...
##  $ New       : Factor w/ 8 levels &quot;ALE&quot;,&quot;Amber&quot;,..: 3 8 1 1 7 5 3 5 8 1 ...</code></pre>
<pre class="r"><code>#plot each beer ABV and IBU individually
ggplot(df1, aes(x=ABV, y=IBU, color=New)) +
  geom_point() +
  geom_jitter() +
  geom_smooth(color=&quot;black&quot;) +
  ggtitle(&quot;Relationship Between ABV vs IBU&quot;) +
  labs(color=&quot;Type of Beer&quot;) +
  facet_wrap(~New)</code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<pre><code>## Warning: Removed 1005 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>## Warning: Removed 1005 rows containing missing values (geom_point).

## Warning: Removed 1005 rows containing missing values (geom_point).</code></pre>
<p><img src="DDS_Project1_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<pre class="r"><code>#boxplot for ABV of each beer
p1 &lt;- ggplot(df1, aes(x=New, y=ABV, fill=New)) +
  geom_boxplot() +
  ggtitle(&quot;Relationship Between Kind of Beer and ABV&quot;) +
  xlab(&quot;Type of Beer&quot;) + 
  theme(legend.position=&quot;none&quot;)
p1</code></pre>
<pre><code>## Warning: Removed 62 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="DDS_Project1_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<pre class="r"><code>#boxplot for IBU of each beer
p2 &lt;- ggplot(df1, aes(x=New, y=IBU, fill=New)) +
  geom_boxplot() +
  ggtitle(&quot;Relationship Between Kind of Beer and IBU&quot;) +
  xlab(&quot;Type of Beer&quot;) + 
  theme(legend.position=&quot;none&quot;)
p2</code></pre>
<pre><code>## Warning: Removed 1005 rows containing non-finite values (stat_boxplot).</code></pre>
<p><img src="DDS_Project1_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
</div>
<div id="number-9b---median-abv-and-ibu-by-state" class="section level1">
<h1>Number 9b - Median ABV and IBU by State</h1>
<pre class="r"><code>#make the data frame to plot
df3.ABV &lt;- df1 %&gt;% group_by(State) %&gt;%
  summarize(medianABV = median(ABV, na.rm = T))

df3.IBU &lt;- df1 %&gt;% group_by(State) %&gt;%
  summarize(medianIBU = median(IBU, na.rm = T))

df4 &lt;- cbind(df3.ABV,df3.IBU)
df4 &lt;- df4[,-3]
colnames(df4)[1] &lt;- &quot;abb&quot;
df4 &lt;- df4[-8,]
lookup = data.frame(abb = state.abb, State = state.name)
df5 &lt;- lookup[order(lookup$abb),]
df6 &lt;- cbind(df4,df5)
df6$region &lt;- tolower(df6$State)
df7 &lt;- df6[,-c(1,4,5)]

#make map df
states &lt;- map_data(&quot;state&quot;)
map.df1 &lt;- merge(states,df7, by=&quot;region&quot;, all.x=T)
map.df1 &lt;- map.df1[order(map.df1$order),]</code></pre>
<pre class="r"><code>#ABV heat plot
ggplot(map.df1, aes(x=long,y=lat,group=group)) +
  geom_polygon(aes(fill=medianABV)) +
  geom_path() + 
  scale_fill_gradientn(colours=rev(heat.colors(10)),na.value=&quot;grey90&quot;) +
  ggtitle(&quot;Median ABV by State&quot;) +
  labs(fill=&quot;Median ABV&quot;) +
  coord_map()</code></pre>
<p><img src="DDS_Project1_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r"><code>#IBU heat plot
ggplot(map.df1, aes(x=long,y=lat,group=group)) +
  geom_polygon(aes(fill=medianIBU)) +
  geom_path() + 
  scale_fill_gradientn(colours=rev(heat.colors(10)),na.value=&quot;grey90&quot;) +
  ggtitle(&quot;Median IBU by State&quot;) +
  labs(fill=&quot;Median IBU&quot;) +
  coord_map()</code></pre>
<p><img src="DDS_Project1_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="conclusion" class="section level1">
<h1>Conclusion</h1>
<p><strong>Based on our visualizations and insights, we concluded that there does appear to be evidence of a positive relationship between ABV and IBU. We were able to accuratly identify if a beer was an ale or an IPA based specifically on those metrics. We also observed similar distributions of ABV and IBU between different subgroups of beer.</strong></p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
